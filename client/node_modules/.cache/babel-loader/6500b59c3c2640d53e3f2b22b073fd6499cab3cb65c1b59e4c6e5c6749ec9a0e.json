{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import io from'socket.io-client';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const socket=io('http://localhost:8080');// Ensure the socket URL matches your server\nfunction LoadBoards(_ref){let{isAdding,setIsAdding,userID,shared,roomID}=_ref;const[boards,setBoards]=useState([]);const[editableBoardId,setEditableBoardId]=useState(null);const[inputValue,setInputValue]=useState('');// Fetch boards when component mounts or roomID changes\nuseEffect(()=>{const fetchBoards=async()=>{try{const response=await axios.get(\"/get_boards/\".concat(roomID));setBoards(response.data.boards);}catch(error){console.error('Failed to fetch boards:',error);}};fetchBoards();},[roomID]);// Handle real-time updates with socket\nuseEffect(()=>{const handleBoardAdded=data=>{if(data.board.room_id===roomID){setBoards(prevBoards=>[...prevBoards,data.board]);}};socket.on('board_added',handleBoardAdded);return()=>{socket.off('board_added',handleBoardAdded);};},[roomID]);useEffect(()=>{if(isAdding&&boards.length>0){const newBoard=boards[boards.length-1];setEditableBoardId(newBoard.id);setInputValue(newBoard.name);setIsAdding(false);}},[isAdding,boards,setIsAdding]);const handleNameChange=e=>{setInputValue(e.target.value);};const handleBlur=async id=>{await updateBoard(id);setEditableBoardId(null);};const handleKeyDown=(e,id)=>{if(e.key==='Enter'){e.currentTarget.blur();}};const updateBoard=async id=>{try{const response=await axios.put(\"/update_board/\".concat(id),{board_name:inputValue,user_id:userID});const updatedBoard=response.data;setBoards(prevBoards=>prevBoards.map(board=>board.id===updatedBoard.id?updatedBoard:board));setIsAdding(false);}catch(error){console.error('Failed to update board:',error);}};return/*#__PURE__*/_jsx(_Fragment,{children:boards.map(board=>/*#__PURE__*/_jsx(\"div\",{className:\"card card-compact w-96 shadow-xl\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",children:[editableBoardId===board.id?/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:inputValue,onChange:handleNameChange,onBlur:()=>handleBlur(board.id),onKeyDown:e=>handleKeyDown(e,board.id),autoFocus:true}):/*#__PURE__*/_jsx(\"h2\",{className:\"card-title text-xl\",onClick:()=>{setEditableBoardId(board.id);setInputValue(board.name);},children:board.name||'New Board'}),/*#__PURE__*/_jsx(\"div\",{})]})},board.id))});}export default LoadBoards;","map":{"version":3,"names":["React","useState","useEffect","axios","io","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","socket","LoadBoards","_ref","isAdding","setIsAdding","userID","shared","roomID","boards","setBoards","editableBoardId","setEditableBoardId","inputValue","setInputValue","fetchBoards","response","get","concat","data","error","console","handleBoardAdded","board","room_id","prevBoards","on","off","length","newBoard","id","name","handleNameChange","e","target","value","handleBlur","updateBoard","handleKeyDown","key","currentTarget","blur","put","board_name","user_id","updatedBoard","map","children","className","type","onChange","onBlur","onKeyDown","autoFocus","onClick"],"sources":["D:/Documents/current-classes/CS4843/Pomigos/client/src/components/BoardTasks.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport io from 'socket.io-client';\r\n\r\nconst socket = io('http://localhost:8080'); // Ensure the socket URL matches your server\r\n\r\nfunction LoadBoards({ isAdding, setIsAdding, userID, shared, roomID }) {\r\n    const [boards, setBoards] = useState([]);\r\n    const [editableBoardId, setEditableBoardId] = useState(null);\r\n    const [inputValue, setInputValue] = useState('');\r\n\r\n    // Fetch boards when component mounts or roomID changes\r\n    useEffect(() => {\r\n        const fetchBoards = async () => {\r\n            try {\r\n                const response = await axios.get(`/get_boards/${roomID}`);\r\n                setBoards(response.data.boards);\r\n            } catch (error) {\r\n                console.error('Failed to fetch boards:', error);\r\n            }\r\n        };\r\n        \r\n        fetchBoards();\r\n    }, [roomID]);\r\n\r\n    // Handle real-time updates with socket\r\n    useEffect(() => {\r\n        const handleBoardAdded = (data) => {\r\n            if (data.board.room_id === roomID) {\r\n                setBoards((prevBoards) => [...prevBoards, data.board]);\r\n            }\r\n        };\r\n\r\n        socket.on('board_added', handleBoardAdded);\r\n\r\n        return () => {\r\n            socket.off('board_added', handleBoardAdded);\r\n        };\r\n    }, [roomID]);\r\n\r\n    useEffect(() => {\r\n        if (isAdding && boards.length > 0) {\r\n            const newBoard = boards[boards.length - 1];\r\n            setEditableBoardId(newBoard.id);\r\n            setInputValue(newBoard.name);\r\n            setIsAdding(false);\r\n        }\r\n    }, [isAdding, boards, setIsAdding]);\r\n\r\n    const handleNameChange = (e) => {\r\n        setInputValue(e.target.value);\r\n    };\r\n\r\n    const handleBlur = async (id) => {\r\n        await updateBoard(id);\r\n        setEditableBoardId(null);\r\n    };\r\n\r\n    const handleKeyDown = (e, id) => {\r\n        if (e.key === 'Enter') {\r\n            e.currentTarget.blur();\r\n        }\r\n    };\r\n\r\n    const updateBoard = async (id) => {\r\n        try {\r\n            const response = await axios.put(`/update_board/${id}`, {\r\n                board_name: inputValue,\r\n                user_id: userID\r\n            });\r\n            const updatedBoard = response.data;\r\n            setBoards((prevBoards) =>\r\n                prevBoards.map((board) =>\r\n                    board.id === updatedBoard.id ? updatedBoard : board\r\n                )\r\n            );\r\n            setIsAdding(false);\r\n        } catch (error) {\r\n            console.error('Failed to update board:', error);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <>\r\n            {boards.map((board) => (\r\n                <div className=\"card card-compact w-96 shadow-xl\" key={board.id}>\r\n                    <div className=\"card-body\">\r\n                        {editableBoardId === board.id ? (\r\n                            <input\r\n                                type=\"text\"\r\n                                value={inputValue}\r\n                                onChange={handleNameChange}\r\n                                onBlur={() => handleBlur(board.id)}\r\n                                onKeyDown={(e) => handleKeyDown(e, board.id)}\r\n                                autoFocus\r\n                            />\r\n                        ) : (\r\n                            <h2 className=\"card-title text-xl\" onClick={() => {\r\n                                setEditableBoardId(board.id);\r\n                                setInputValue(board.name);\r\n                            }}>\r\n                                {board.name || 'New Board'}\r\n                            </h2>\r\n                        )}\r\n                        <div></div>\r\n                    </div>\r\n                </div>\r\n            ))}\r\n        </>\r\n    );\r\n}\r\n\r\nexport default LoadBoards;"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,MAAO,CAAAC,EAAE,KAAM,kBAAkB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBAElC,KAAM,CAAAC,MAAM,CAAGP,EAAE,CAAC,uBAAuB,CAAC,CAAE;AAE5C,QAAS,CAAAQ,UAAUA,CAAAC,IAAA,CAAoD,IAAnD,CAAEC,QAAQ,CAAEC,WAAW,CAAEC,MAAM,CAAEC,MAAM,CAAEC,MAAO,CAAC,CAAAL,IAAA,CACjE,KAAM,CAACM,MAAM,CAAEC,SAAS,CAAC,CAAGnB,QAAQ,CAAC,EAAE,CAAC,CACxC,KAAM,CAACoB,eAAe,CAAEC,kBAAkB,CAAC,CAAGrB,QAAQ,CAAC,IAAI,CAAC,CAC5D,KAAM,CAACsB,UAAU,CAAEC,aAAa,CAAC,CAAGvB,QAAQ,CAAC,EAAE,CAAC,CAEhD;AACAC,SAAS,CAAC,IAAM,CACZ,KAAM,CAAAuB,WAAW,CAAG,KAAAA,CAAA,GAAY,CAC5B,GAAI,CACA,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAvB,KAAK,CAACwB,GAAG,gBAAAC,MAAA,CAAgBV,MAAM,CAAE,CAAC,CACzDE,SAAS,CAACM,QAAQ,CAACG,IAAI,CAACV,MAAM,CAAC,CACnC,CAAE,MAAOW,KAAK,CAAE,CACZC,OAAO,CAACD,KAAK,CAAC,yBAAyB,CAAEA,KAAK,CAAC,CACnD,CACJ,CAAC,CAEDL,WAAW,CAAC,CAAC,CACjB,CAAC,CAAE,CAACP,MAAM,CAAC,CAAC,CAEZ;AACAhB,SAAS,CAAC,IAAM,CACZ,KAAM,CAAA8B,gBAAgB,CAAIH,IAAI,EAAK,CAC/B,GAAIA,IAAI,CAACI,KAAK,CAACC,OAAO,GAAKhB,MAAM,CAAE,CAC/BE,SAAS,CAAEe,UAAU,EAAK,CAAC,GAAGA,UAAU,CAAEN,IAAI,CAACI,KAAK,CAAC,CAAC,CAC1D,CACJ,CAAC,CAEDtB,MAAM,CAACyB,EAAE,CAAC,aAAa,CAAEJ,gBAAgB,CAAC,CAE1C,MAAO,IAAM,CACTrB,MAAM,CAAC0B,GAAG,CAAC,aAAa,CAAEL,gBAAgB,CAAC,CAC/C,CAAC,CACL,CAAC,CAAE,CAACd,MAAM,CAAC,CAAC,CAEZhB,SAAS,CAAC,IAAM,CACZ,GAAIY,QAAQ,EAAIK,MAAM,CAACmB,MAAM,CAAG,CAAC,CAAE,CAC/B,KAAM,CAAAC,QAAQ,CAAGpB,MAAM,CAACA,MAAM,CAACmB,MAAM,CAAG,CAAC,CAAC,CAC1ChB,kBAAkB,CAACiB,QAAQ,CAACC,EAAE,CAAC,CAC/BhB,aAAa,CAACe,QAAQ,CAACE,IAAI,CAAC,CAC5B1B,WAAW,CAAC,KAAK,CAAC,CACtB,CACJ,CAAC,CAAE,CAACD,QAAQ,CAAEK,MAAM,CAAEJ,WAAW,CAAC,CAAC,CAEnC,KAAM,CAAA2B,gBAAgB,CAAIC,CAAC,EAAK,CAC5BnB,aAAa,CAACmB,CAAC,CAACC,MAAM,CAACC,KAAK,CAAC,CACjC,CAAC,CAED,KAAM,CAAAC,UAAU,CAAG,KAAO,CAAAN,EAAE,EAAK,CAC7B,KAAM,CAAAO,WAAW,CAACP,EAAE,CAAC,CACrBlB,kBAAkB,CAAC,IAAI,CAAC,CAC5B,CAAC,CAED,KAAM,CAAA0B,aAAa,CAAGA,CAACL,CAAC,CAAEH,EAAE,GAAK,CAC7B,GAAIG,CAAC,CAACM,GAAG,GAAK,OAAO,CAAE,CACnBN,CAAC,CAACO,aAAa,CAACC,IAAI,CAAC,CAAC,CAC1B,CACJ,CAAC,CAED,KAAM,CAAAJ,WAAW,CAAG,KAAO,CAAAP,EAAE,EAAK,CAC9B,GAAI,CACA,KAAM,CAAAd,QAAQ,CAAG,KAAM,CAAAvB,KAAK,CAACiD,GAAG,kBAAAxB,MAAA,CAAkBY,EAAE,EAAI,CACpDa,UAAU,CAAE9B,UAAU,CACtB+B,OAAO,CAAEtC,MACb,CAAC,CAAC,CACF,KAAM,CAAAuC,YAAY,CAAG7B,QAAQ,CAACG,IAAI,CAClCT,SAAS,CAAEe,UAAU,EACjBA,UAAU,CAACqB,GAAG,CAAEvB,KAAK,EACjBA,KAAK,CAACO,EAAE,GAAKe,YAAY,CAACf,EAAE,CAAGe,YAAY,CAAGtB,KAClD,CACJ,CAAC,CACDlB,WAAW,CAAC,KAAK,CAAC,CACtB,CAAE,MAAOe,KAAK,CAAE,CACZC,OAAO,CAACD,KAAK,CAAC,yBAAyB,CAAEA,KAAK,CAAC,CACnD,CACJ,CAAC,CAED,mBACIxB,IAAA,CAAAI,SAAA,EAAA+C,QAAA,CACKtC,MAAM,CAACqC,GAAG,CAAEvB,KAAK,eACd3B,IAAA,QAAKoD,SAAS,CAAC,kCAAkC,CAAAD,QAAA,cAC7CjD,KAAA,QAAKkD,SAAS,CAAC,WAAW,CAAAD,QAAA,EACrBpC,eAAe,GAAKY,KAAK,CAACO,EAAE,cACzBlC,IAAA,UACIqD,IAAI,CAAC,MAAM,CACXd,KAAK,CAAEtB,UAAW,CAClBqC,QAAQ,CAAElB,gBAAiB,CAC3BmB,MAAM,CAAEA,CAAA,GAAMf,UAAU,CAACb,KAAK,CAACO,EAAE,CAAE,CACnCsB,SAAS,CAAGnB,CAAC,EAAKK,aAAa,CAACL,CAAC,CAAEV,KAAK,CAACO,EAAE,CAAE,CAC7CuB,SAAS,MACZ,CAAC,cAEFzD,IAAA,OAAIoD,SAAS,CAAC,oBAAoB,CAACM,OAAO,CAAEA,CAAA,GAAM,CAC9C1C,kBAAkB,CAACW,KAAK,CAACO,EAAE,CAAC,CAC5BhB,aAAa,CAACS,KAAK,CAACQ,IAAI,CAAC,CAC7B,CAAE,CAAAgB,QAAA,CACGxB,KAAK,CAACQ,IAAI,EAAI,WAAW,CAC1B,CACP,cACDnC,IAAA,SAAU,CAAC,EACV,CAAC,EApB6C2B,KAAK,CAACO,EAqBxD,CACR,CAAC,CACJ,CAAC,CAEX,CAEA,cAAe,CAAA5B,UAAU","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}